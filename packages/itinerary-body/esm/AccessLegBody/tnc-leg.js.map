{"version":3,"sources":["../../src/AccessLegBody/tnc-leg.tsx"],"names":["coreUtils","React","FormattedMessage","FormattedNumber","getCompanyForNetwork","Duration","S","defaultMessages","parseOTP2Minute","AccessLegSummary","TNCLeg","config","followsTransit","leg","LegIcon","LYFT_CLIENT_ID","onSummaryClick","showLegIcon","UBER_CLIENT_ID","universalLinks","uber","ui","isMobile","from","lat","lon","encodeURI","name","to","lyft","rideHailingEstimate","company","provider","id","companies","label","minutes","parseInt","arrival","startTime","timeMillis","duration","minPrice","maxFare","maxPrice","currency","code","amount","minFare"],"mappings":"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","sourcesContent":["import coreUtils from \"@opentripplanner/core-utils\";\nimport { Config, Leg, LegIconComponent } from \"@opentripplanner/types\";\nimport React, { ReactElement } from \"react\";\nimport { FormattedMessage, FormattedNumber } from \"react-intl\";\nimport { getCompanyForNetwork } from \"@opentripplanner/core-utils/lib/itinerary\";\nimport { Duration } from \"../defaults\";\n\nimport * as S from \"../styled\";\nimport { defaultMessages, parseOTP2Minute } from \"../util\";\n\nimport AccessLegSummary from \"./access-leg-summary\";\n\ninterface Props {\n  config: Config;\n  followsTransit: boolean;\n  leg: Leg;\n  LegIcon: LegIconComponent;\n  LYFT_CLIENT_ID?: string;\n  onSummaryClick: () => void;\n  showLegIcon: boolean;\n  UBER_CLIENT_ID?: string;\n}\n\nexport default function TNCLeg({\n  config,\n  followsTransit,\n  leg,\n  LegIcon,\n  LYFT_CLIENT_ID = \"\",\n  onSummaryClick,\n  showLegIcon,\n  UBER_CLIENT_ID = \"\"\n}: Props): ReactElement {\n  const universalLinks = {\n    uber: `https://m.uber.com/${\n      coreUtils.ui.isMobile() ? \"ul/\" : \"\"\n    }?client_id=${UBER_CLIENT_ID}&action=setPickup&pickup[latitude]=${\n      leg.from.lat\n    }&pickup[longitude]=${leg.from.lon}&pickup[formatted_address]=${encodeURI(\n      leg.from.name\n    )}&dropoff[latitude]=${leg.to.lat}&dropoff[longitude]=${\n      leg.to.lon\n    }&dropoff[formatted_address]=${encodeURI(leg.to.name)}`,\n    lyft: `https://lyft.com/ride?id=lyft&partner=${LYFT_CLIENT_ID}&pickup[latitude]=${leg.from.lat}&pickup[longitude]=${leg.from.lon}&destination[latitude]=${leg.to.lat}&destination[longitude]=${leg.to.lon}`\n  };\n  const { rideHailingEstimate } = leg;\n  if (!rideHailingEstimate) return null;\n  return (\n    <div>\n      <S.PlaceSubheader>\n        <FormattedMessage\n          defaultMessage={\n            defaultMessages[\"otpUi.AccessLegBody.TncLeg.waitForPickup\"]\n          }\n          description=\"Action text for waiting for a ride-hail vehicle.\"\n          id=\"otpUi.AccessLegBody.TncLeg.waitForPickup\"\n          values={{\n            company: getCompanyForNetwork(\n              rideHailingEstimate.provider.id,\n              config.companies\n            )?.label,\n            minutes: followsTransit\n              ? 0\n              : parseInt(parseOTP2Minute(leg.rideHailingEstimate.arrival), 10)\n          }}\n        />\n      </S.PlaceSubheader>\n\n      <S.LegBody>\n        {/* The icon/summary row */}\n        <AccessLegSummary\n          config={config}\n          leg={leg}\n          LegIcon={LegIcon}\n          onSummaryClick={onSummaryClick}\n          showLegIcon={showLegIcon}\n        />\n\n        {/* The \"Book Ride\" button */}\n        <S.BookTNCRideButtonContainer>\n          <S.BookTNCRideButton\n            href={universalLinks[rideHailingEstimate.provider.id]}\n            target={coreUtils.ui.isMobile() ? \"_self\" : \"_blank\"}\n          >\n            <FormattedMessage\n              defaultMessage={\n                defaultMessages[\"otpUi.AccessLegBody.TncLeg.bookRide\"]\n              }\n              description=\"Action text to book a ride with a ride-hail company.\"\n              id=\"otpUi.AccessLegBody.TncLeg.bookRide\"\n            />\n          </S.BookTNCRideButton>\n          {followsTransit && <S.BookLaterPointer />}\n          {followsTransit && typeof leg.startTime === \"number\" && (\n            <S.BookLaterContainer>\n              <S.BookLaterInnerContainer>\n                <S.BookLaterText>\n                  <FormattedMessage\n                    defaultMessage={\n                      defaultMessages[\n                        \"otpUi.AccessLegBody.TncLeg.bookRideLater\"\n                      ]\n                    }\n                    description=\"Hint text to book a ride at a later time.\"\n                    id=\"otpUi.AccessLegBody.TncLeg.bookRideLater\"\n                    values={{\n                      timeMillis:\n                        leg.startTime -\n                        parseInt(\n                          parseOTP2Minute(rideHailingEstimate.arrival),\n                          10\n                        )\n                    }}\n                  />\n                </S.BookLaterText>\n              </S.BookLaterInnerContainer>\n            </S.BookLaterContainer>\n          )}\n        </S.BookTNCRideButtonContainer>\n\n        {/* The estimated travel time */}\n        <S.TNCTravelTime>\n          <FormattedMessage\n            defaultMessage={\n              defaultMessages[\"otpUi.AccessLegBody.TncLeg.estimatedTravelTime\"]\n            }\n            description=\"Describes the estimated travel time.\"\n            id=\"otpUi.AccessLegBody.TncLeg.estimatedTravelTime\"\n            values={{\n              duration: <Duration seconds={leg.duration} />\n            }}\n          />\n        </S.TNCTravelTime>\n\n        {/* The estimated travel cost */}\n        {rideHailingEstimate.minPrice && (\n          <S.TNCCost>\n            <FormattedMessage\n              defaultMessage={\n                defaultMessages[\"otpUi.AccessLegBody.TncLeg.estimatedCost\"]\n              }\n              description=\"Shows the minimum and maximum fares for a TNC ride.\"\n              id=\"otpUi.AccessLegBody.TncLeg.estimatedCost\"\n              values={{\n                maxFare: (\n                  <FormattedNumber\n                    currency={rideHailingEstimate.maxPrice.currency.code}\n                    currencyDisplay=\"narrowSymbol\"\n                    // This isn't a \"real\" style prop\n                    // eslint-disable-next-line react/style-prop-object\n                    style=\"currency\"\n                    value={rideHailingEstimate.maxPrice.amount}\n                  />\n                ),\n                minFare: (\n                  <FormattedNumber\n                    currency={rideHailingEstimate.minPrice.currency.code}\n                    currencyDisplay=\"narrowSymbol\"\n                    // This isn't a \"real\" style prop\n                    // eslint-disable-next-line react/style-prop-object\n                    style=\"currency\"\n                    value={rideHailingEstimate.minPrice.amount}\n                  />\n                )\n              }}\n            />\n          </S.TNCCost>\n        )}\n      </S.LegBody>\n    </div>\n  );\n}\n"],"file":"tnc-leg.js"}